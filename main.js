!function(){"use strict";const e=[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}];e.reverse();var t=e;document.querySelector(".places");const s=document.querySelector("#place-template"),n=document.querySelector(".popup_type_edit").querySelector(".popup__form"),i=document.querySelector(".popup_type_add").querySelector(".popup__form"),o=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button"),l=document.querySelector(".popup__input_type_name"),a=document.querySelector(".popup__input_type_profession"),p={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var _=class{constructor(e,t){c(this,"_showInputError",(e=>{const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)})),c(this,"_hideInputError",(e=>{const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)})),c(this,"_hasOnlyValidInputs",(()=>this._inputList.every((e=>e.validity.valid)))),c(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),c(this,"_setEventListeners",(()=>{this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),c(this,"_toggleButton",(()=>{this._hasOnlyValidInputs()?(this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass)):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)})),c(this,"resetFormValidation",(()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()})),c(this,"enableValidation",(()=>{this._setEventListeners()})),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}},h=class{constructor(e){this._popupElement=document.querySelector(e),this._handleEscUp=this._handleEscUp.bind(this),this.close=this.close.bind(this)}_handleEscUp(e){e.preventDefault(),"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("click",this.close),this._popupElement.addEventListener("mousedown",(e=>{[...e.target.classList].includes("popup")&&this.close()}))}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscUp)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscUp)}},d=class extends h{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".popup__form"),this._inputList=Array.from(this._popupForm.querySelectorAll(".popup__input")),this._submitHandler=t}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._popupForm.reset(),super.close()}};function m(e){E.addItem(function(e){return new class{constructor(e,t,s){u(this,"_setEventListeners",(()=>{this._cardElement.querySelector(".place__image").addEventListener("click",(()=>this._handleCardClick(this._name,this._link))),this._cardElement.querySelector(".place__button").addEventListener("click",this._handleLikeButton),this._cardElement.querySelector(".place__trash").addEventListener("click",this._handleDeleteButton)})),u(this,"_handleLikeButton",(()=>this._cardElement.querySelector(".place__button").classList.toggle("place__button_active"))),u(this,"_handleDeleteButton",(()=>this._cardElement.remove())),u(this,"_getTemplate",(()=>this._cardSelector.content.querySelector(".places__item").cloneNode(!0))),u(this,"getElement",(()=>(this._cardElement=this._getTemplate(),this._setEventListeners(),this._cardElement.querySelector(".place__image").style.backgroundImage="url(".concat(this._link,")"),this._cardElement.querySelector(".place__title").textContent=this._name,this._cardElement))),this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s}}({name:e.name,link:e.link},s,y).getElement()}(e))}function y(e,t){b.open(e,t)}const E=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}render(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:t,renderer:m},".places");E.render();const v=new class{constructor(e){let{nameSelector:t,professionSelector:s}=e;this._userName=document.querySelector(t),this._userProfession=document.querySelector(s)}getUserInfo(){return{name:this._userName.textContent,profession:this._userProfession.textContent}}setUserInfo(e){let{name:t,profession:s}=e;this._userName.textContent=t,this._userProfession.textContent=s}}({nameSelector:".profile__name",professionSelector:".profile__profession"}),b=new class extends h{open(e,t){this._title=this._popupElement.querySelector(".popup__image-name"),this._image=this._popupElement.querySelector(".popup__image-preview"),this._title.textContent=e,this._image.src=t,this._image.alt="Image of ".concat(e),super.open()}}(".popup_type_preview");b.setEventListeners();const f=new d(".popup_type_edit",(e=>{v.setUserInfo(e)}));f.setEventListeners();const S=new d(".popup_type_add",(e=>{m({name:e.title,link:e.link})}));S.setEventListeners();const L=new _(p,n),g=new _(p,i);L.enableValidation(),g.enableValidation(),o.addEventListener("click",(()=>{const e=v.getUserInfo();f.open(),l.value=e.name,a.value=e.profession,L.resetFormValidation()})),r.addEventListener("click",(()=>{g.resetFormValidation(),S.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQVU1RCxvQkFFVixNQUFNOEQsRUFBVyxJQUFJRCxFQUFjLG1CQUFvQjFDLElBQ25ESixFQUFZLENBQ1I1RSxLQUFNZ0YsRUFBSzRDLE1BQ1gzSCxLQUFNK0UsRUFBSy9FLFVBSW5CMEgsRUFBUzlELG9CQUVULE1BQU1nRSxFQUFvQixJQUFJQyxFQUFjbEgsRUFBb0JOLEdBQzFEeUgsRUFBbUIsSUFBSUQsRUFBY2xILEVBQW9CTCxHQUUvRHNILEVBQWtCRyxtQkFDbEJELEVBQWlCQyxtQkFJakJ4SCxFQUFRdUMsaUJBQWlCLFNBQVMsS0FDOUIsTUFBTWlDLEVBQU82QixFQUFTSyxjQUN0Qk8sRUFBVXpELE9BQ1Z0RCxFQUFlZ0UsTUFBUU0sRUFBS2hGLEtBQzVCVyxFQUFxQitELE1BQVFNLEVBQUttQyxXQUNsQ1UsRUFBa0JJLHlCQUl0QnhILEVBQU9zQyxpQkFBaUIsU0FBUyxLQUM3QmdGLEVBQWlCRSxzQkFDakJOLEVBQVMzRCxVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZm91cnRoLXByb2plY3QvLi9zcmMvdXRpbHMvaW5pdGlhbGNhcmRzLmpzIiwid2VicGFjazovL2ZvdXJ0aC1wcm9qZWN0Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9mb3VydGgtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vZm91cnRoLXByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9mb3VydGgtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vZm91cnRoLXByb2plY3QvLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9mb3VydGgtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vZm91cnRoLXByb2plY3QvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL2ZvdXJ0aC1wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vZm91cnRoLXByb2plY3QvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpbml0aWFsQ2FyZHMgPSBbe1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbn0sXHJcbntcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbn0sXHJcbntcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbn0sXHJcbntcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG59LFxyXG57XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG59LFxyXG57XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbn0sXHJcbl07XHJcblxyXG5pbml0aWFsQ2FyZHMucmV2ZXJzZSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgaW5pdGlhbENhcmRzOyIsImV4cG9ydCBjb25zdCBwbGFjZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc1wiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxhY2UtdGVtcGxhdGVcIik7XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdFwiKS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGRcIikucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cElucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW5wdXRQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdHlwZV9wcm9mZXNzaW9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCJcclxufTsiLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgICAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuXHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWwpID0+IHtcclxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgZXJyb3JNZXNzYWdlLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgICAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgICAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFzT25seVZhbGlkSW5wdXRzID0gKCkgPT4gdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsKSA9PiB7XHJcbiAgICAgICAgaWYgKGlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICBcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX3RvZ2dsZUJ1dHRvbiA9ICgpID0+IHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc09ubHlWYWxpZElucHV0cygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRGb3JtVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImNsYXNzIFBvcHVwIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NVcCA9IHRoaXMuX2hhbmRsZUVzY1VwLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjVXAoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChbLi4uZS50YXJnZXQuY2xhc3NMaXN0XS5pbmNsdWRlcyhcInBvcHVwXCIpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjVXApO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NVcCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cDsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKSk7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG5cclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgaW5pdGlhbENhcmRzIGZyb20gXCIuLi91dGlscy9pbml0aWFsY2FyZHMuanNcIjtcclxuaW1wb3J0IHsgcGxhY2VzLCBjYXJkVGVtcGxhdGUsIGVkaXRGb3JtLCBhZGRGb3JtLCBlZGl0QnRuLCBhZGRCdG4sIHBvcHVwSW5wdXROYW1lLCBwb3B1cElucHV0UHJvZmVzc2lvbiwgdmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZCkge1xyXG4gICAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKHtcclxuICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXHJcbiAgICAgICAgbGluazogY2FyZC5saW5rXHJcbiAgICB9LFxyXG4gICAgY2FyZFRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICApXHJcbiAgICByZXR1cm4gbmV3Q2FyZC5nZXRFbGVtZW50KClcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyUGxhY2UoY2FyZCkge1xyXG4gICAgc2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoY2FyZCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2sgKG5hbWUsIGxpbmspIHtcclxuICAgIGltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogcmVuZGVyUGxhY2UsXHJcbn0sIFwiLnBsYWNlc1wiKTtcclxuXHJcbnNlY3Rpb24ucmVuZGVyKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICAgIHByb2Zlc3Npb25TZWxlY3RvcjogXCIucHJvZmlsZV9fcHJvZmVzc2lvblwiXHJcbn0pO1xyXG5cclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5wb3B1cF90eXBlX3ByZXZpZXdcIik7XHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfZWRpdFwiLCAoZGF0YSkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSlcclxufSk7XHJcblxyXG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGFkZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9hZGRcIiwgKGRhdGEpID0+IHtcclxuICAgIHJlbmRlclBsYWNlKHtcclxuICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGlua1xyXG4gICAgfSwgcGxhY2VzKVxyXG59KTtcclxuXHJcbmFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm0pO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRGb3JtKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vL0V2ZW50IExpc3RlbmVyc1xyXG5cclxuZWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKClcclxuICAgIGVkaXRQb3B1cC5vcGVuKCk7XHJcbiAgICBwb3B1cElucHV0TmFtZS52YWx1ZSA9IGRhdGEubmFtZTtcclxuICAgIHBvcHVwSW5wdXRQcm9mZXNzaW9uLnZhbHVlID0gZGF0YS5wcm9mZXNzaW9uO1xyXG4gICAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRGb3JtVmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcblxyXG5hZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRGb3JtVmFsaWRhdGlvbigpO1xyXG4gICAgYWRkUG9wdXAub3BlbigpO1xyXG59KTsiLCJjbGFzcyBDYXJkIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaykge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuXHJcbiAgICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZV9faW1hZ2VcIilcclxuICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX2J1dHRvblwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX3RyYXNoXCIpXHJcbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24pO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVMaWtlQnV0dG9uID0gKCkgPT4gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZV9fYnV0dG9uXCIpXHJcbiAgICAuY2xhc3NMaXN0LnRvZ2dsZShcInBsYWNlX19idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgXHJcblxyXG4gICAgX2hhbmRsZURlbGV0ZUJ1dHRvbiA9ICgpID0+IHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG5cclxuICAgIF9nZXRUZW1wbGF0ZSA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZFNlbGVjdG9yXHJcbiAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2l0ZW1cIilcclxuICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEVsZW1lbnQgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX2ltYWdlXCIpXHJcbiAgICAgICAgLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9saW5rfSlgO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJjbGFzcyBTZWN0aW9uIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uOyIsIi8vIFdvcmsgaW4gUHJvZ3Jlc3NcclxuXHJcbmNsYXNzIFVzZXJJbmZvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgcHJvZmVzc2lvblNlbGVjdG9yIH0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91c2VyUHJvZmVzc2lvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmVzc2lvblNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIHByb2Zlc3Npb246IHRoaXMuX3VzZXJQcm9mZXNzaW9uLnRleHRDb250ZW50IFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8oeyBuYW1lLCBwcm9mZXNzaW9uIH0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWVcclxuICAgICAgICB0aGlzLl91c2VyUHJvZmVzc2lvbi50ZXh0Q29udGVudCA9IHByb2Zlc3Npb25cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvOyIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcblxyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtbmFtZVwiKTtcclxuICAgICAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS1wcmV2aWV3XCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IGBJbWFnZSBvZiAke25hbWV9YFxyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlOyJdLCJuYW1lcyI6WyJpbml0aWFsQ2FyZHMiLCJuYW1lIiwibGluayIsInJldmVyc2UiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjYXJkVGVtcGxhdGUiLCJlZGl0Rm9ybSIsImFkZEZvcm0iLCJlZGl0QnRuIiwiYWRkQnRuIiwicG9wdXBJbnB1dE5hbWUiLCJwb3B1cElucHV0UHJvZmVzc2lvbiIsInZhbGlkYXRpb25TZXR0aW5ncyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZSIsInRoaXMiLCJfZm9ybSIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNsYXNzTGlzdCIsImFkZCIsIl9lcnJvckNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsInJlbW92ZSIsIl9pbnB1dExpc3QiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3RvZ2dsZUJ1dHRvbiIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9oYXNPbmx5VmFsaWRJbnB1dHMiLCJkaXNhYmxlZCIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjVXAiLCJiaW5kIiwiY2xvc2UiLCJlIiwicHJldmVudERlZmF1bHQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImluY2x1ZGVzIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQb3B1cCIsInN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfc3VibWl0SGFuZGxlciIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicmVuZGVyUGxhY2UiLCJjYXJkIiwic2VjdGlvbiIsImFkZEl0ZW0iLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiX2NhcmRFbGVtZW50IiwiX2hhbmRsZUNhcmRDbGljayIsIl9uYW1lIiwiX2xpbmsiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJ0b2dnbGUiLCJfY2FyZFNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9nZXRUZW1wbGF0ZSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiZ2V0RWxlbWVudCIsImNyZWF0ZUNhcmQiLCJpbWFnZVBvcHVwIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlciIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwicHJvZmVzc2lvblNlbGVjdG9yIiwiX3VzZXJOYW1lIiwiX3VzZXJQcm9mZXNzaW9uIiwiZ2V0VXNlckluZm8iLCJwcm9mZXNzaW9uIiwic2V0VXNlckluZm8iLCJfdGl0bGUiLCJfaW1hZ2UiLCJzcmMiLCJhbHQiLCJlZGl0UG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwiYWRkUG9wdXAiLCJ0aXRsZSIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwicmVzZXRGb3JtVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=