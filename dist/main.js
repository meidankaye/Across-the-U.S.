(()=>{"use strict";const e=document.querySelector(".popup_type_preview"),t=document.querySelector(".popup__image-preview"),r=document.querySelector(".popup__image-name"),i=Array.from(document.querySelectorAll(".popup")),n=e=>{e.classList.add("popup_opened"),document.addEventListener("keydown",s)},o=()=>{i.forEach((e=>e.classList.remove("popup_opened"))),document.removeEventListener("keydown",s)},s=e=>{"Escape"===e.key&&o()};i.forEach((e=>{e.addEventListener("mousedown",(e=>{e.target==e.currentTarget&&o()}))}));const l=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError=e=>{const t=this._form.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)};_hideInputError=e=>{const t=this._form.querySelector(`#${e.id}-error`);t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)};_hasOnlyValidInputs=()=>this._inputList.every((e=>e.validity.valid));_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)};_setEventListeners=()=>{this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))};_toggleButton=()=>{const e=this._form.querySelector(this._submitButtonSelector);this._hasOnlyValidInputs()?(e.disabled=!1,e.classList.remove(this._inactiveButtonClass)):(e.classList.add(this._inactiveButtonClass),e.disabled=!0)};resetFormValidation=()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()};enableValidation=()=>{this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}},a=document.querySelector(".popup_type_edit"),u=document.querySelector(".popup_type_add"),_=document.querySelector(".places"),c=a.querySelector(".popup__form"),p=u.querySelector(".popup__form"),d=document.querySelector(".profile__name"),h=document.querySelector(".profile__profession"),m=document.querySelector(".profile__edit-button"),y=document.querySelector(".profile__add-button"),v=Array.from(document.querySelectorAll(".popup__close-button")),E=document.querySelector(".popup__input_type_name"),S=document.querySelector(".popup__input_type_profession"),L=document.querySelector(".popup__input_type_title"),q=document.querySelector(".popup__input_type_link"),f={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},g=new l(f,c),C=new l(f,p);g.enableValidation(),C.enableValidation(),m.addEventListener("click",(()=>{E.value=d.textContent,S.value=h.textContent,n(a)})),c.addEventListener("submit",(e=>{d.textContent=E.value,h.textContent=S.value,o(),e.preventDefault()})),y.addEventListener("click",(()=>{C.resetFormValidation(p),n(u)})),p.addEventListener("submit",(e=>{e.preventDefault(),b({name:L.value,link:q.value},_),o(),p.reset()})),v.forEach((e=>e.addEventListener("click",o)));const k=document.querySelector("#place-template");function b(i,o){const s=new class{constructor(e,t){this._name=e.name,this._link=e.link,this._cardSelector=t}_setEventListeners=()=>{this._imageElem=this._cardElement.querySelector(".place__image"),this._cardLikeBtn=this._cardElement.querySelector(".place__button"),this._cardDeleteBtn=this._cardElement.querySelector(".place__trash"),this._imageElem.addEventListener("click",this._handlePreviewImage),this._cardLikeBtn.addEventListener("click",this._handleLikeButton),this._cardDeleteBtn.addEventListener("click",this._handleDeleteButton)};_handlePreviewImage=()=>{t.src=this._link,t.alt=`Image of ${this._name}`,r.textContent=this._name,n(e)};_handleLikeButton=()=>this._cardLikeBtn.classList.toggle("place__button_active");_handleDeleteButton=()=>this._cardElement.remove();_getTemplate=()=>this._cardSelector.content.querySelector(".places__item").cloneNode(!0);getElement=()=>(this._cardElement=this._getTemplate(),this._setEventListeners(),this._cardElement.querySelector(".place__image").style.backgroundImage=`url(${this._link})`,this._cardElement.querySelector(".place__title").textContent=this._name,this._cardElement)}(i,k);o.prepend(s.getElement())}initialCards.forEach((e=>{b(e,_)}))})();