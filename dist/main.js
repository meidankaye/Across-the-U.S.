!function(){"use strict";const e=document.querySelector(".popup_type_preview"),t=document.querySelector(".popup__image-preview"),n=document.querySelector(".popup__image-name"),i=Array.from(document.querySelectorAll(".popup")),r=e=>{e.classList.add("popup_opened"),document.addEventListener("keydown",s)},o=()=>{i.forEach((e=>e.classList.remove("popup_opened"))),document.removeEventListener("keydown",s)},s=e=>{"Escape"===e.key&&o()};function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i.forEach((e=>{e.addEventListener("mousedown",(e=>{e.target==e.currentTarget&&o()}))}));function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=class{constructor(e,t){l(this,"_showInputError",(e=>{const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)})),l(this,"_hideInputError",(e=>{const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)})),l(this,"_hasOnlyValidInputs",(()=>this._inputList.every((e=>e.validity.valid)))),l(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),l(this,"_setEventListeners",(()=>{this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),l(this,"_toggleButton",(()=>{const e=this._form.querySelector(this._submitButtonSelector);this._hasOnlyValidInputs()?(e.disabled=!1,e.classList.remove(this._inactiveButtonClass)):(e.classList.add(this._inactiveButtonClass),e.disabled=!0)})),l(this,"resetFormValidation",(()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()})),l(this,"enableValidation",(()=>{this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()})),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}};const u=[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}];u.reverse();const _=document.querySelector(".popup_type_edit"),p=document.querySelector(".popup_type_add"),d=document.querySelector(".places"),h=_.querySelector(".popup__form"),m=p.querySelector(".popup__form"),y=document.querySelector(".profile__name"),v=document.querySelector(".profile__profession"),E=document.querySelector(".profile__edit-button"),L=document.querySelector(".profile__add-button"),S=Array.from(document.querySelectorAll(".popup__close-button")),g=document.querySelector(".popup__input_type_name"),b=document.querySelector(".popup__input_type_profession"),f=document.querySelector(".popup__input_type_title"),k=document.querySelector(".popup__input_type_link"),q={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},B=new c(q,h),C=new c(q,m);B.enableValidation(),C.enableValidation(),E.addEventListener("click",(()=>{g.value=y.textContent,b.value=v.textContent,r(_)})),h.addEventListener("submit",(e=>{y.textContent=g.value,v.textContent=b.value,o(),e.preventDefault()})),L.addEventListener("click",(()=>{C.resetFormValidation(m),r(p)})),m.addEventListener("submit",(e=>{e.preventDefault(),x({name:f.value,link:k.value},d),o(),m.reset()})),S.forEach((e=>e.addEventListener("click",o)));const w=document.querySelector("#place-template");function x(i,o){const s=new class{constructor(i,o){a(this,"_setEventListeners",(()=>{this._imageElem=this._cardElement.querySelector(".place__image"),this._cardLikeBtn=this._cardElement.querySelector(".place__button"),this._cardDeleteBtn=this._cardElement.querySelector(".place__trash"),this._imageElem.addEventListener("click",this._handlePreviewImage),this._cardLikeBtn.addEventListener("click",this._handleLikeButton),this._cardDeleteBtn.addEventListener("click",this._handleDeleteButton)})),a(this,"_handlePreviewImage",(()=>{t.src=this._link,t.alt="Image of ".concat(this._name),n.textContent=this._name,r(e)})),a(this,"_handleLikeButton",(()=>this._cardLikeBtn.classList.toggle("place__button_active"))),a(this,"_handleDeleteButton",(()=>this._cardElement.remove())),a(this,"_getTemplate",(()=>this._cardSelector.content.querySelector(".places__item").cloneNode(!0))),a(this,"getElement",(()=>(this._cardElement=this._getTemplate(),this._setEventListeners(),this._cardElement.querySelector(".place__image").style.backgroundImage="url(".concat(this._link,")"),this._cardElement.querySelector(".place__title").textContent=this._name,this._cardElement))),this._name=i.name,this._link=i.link,this._cardSelector=o}}(i,w);o.prepend(s.getElement())}u.forEach((e=>{x(e,d)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxLQUFLNkQsZ0JBM0NaN0QsS0FBS3NFLE1BQVFkLEVBQUszQixLQUNsQjdCLEtBQUtvRSxNQUFRWixFQUFLMUIsS0FFbEI5QixLQUFLd0UsY0FBZ0JiLElENEhISCxFQUFNRCxHQUM1QkUsRUFBVXFCLFFBQVFwQixFQUFLcUIsY0FHM0JuRCxFQUFhekMsU0FBU3FFLElBQ2xCSCxFQUFZRyxFQUFNdEIsTSIsInNvdXJjZXMiOlsid2VicGFjazovL2ZvdXJ0aC1wcm9qZWN0Ly4vc2NyaXB0cy91dGlscy5qcyIsIndlYnBhY2s6Ly9mb3VydGgtcHJvamVjdC8uL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9mb3VydGgtcHJvamVjdC8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9mb3VydGgtcHJvamVjdC8uL3NjcmlwdHMvQ2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW1hZ2VQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9wcmV2aWV3XCIpO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtcHJldmlld1wiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlLW5hbWVcIik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cExpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIikpO1xyXG5cclxuZXhwb3J0IGNvbnN0IG9wZW5Qb3B1cCA9IChwb3B1cCkgPT4ge1xyXG4gICAgcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlUG9wdXBFc2MpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNsb3NlUG9wdXAgPSAoKSA9PiB7XHJcbiAgICBwb3B1cExpc3QuZm9yRWFjaCgocG9wdXApID0+IHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIikpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VQb3B1cEVzYyk7XHJcbn07XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IGNsb3NlUG9wdXBFc2MgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgY2xvc2VQb3B1cChwb3B1cExpc3QpO1xyXG4gICAgfVxyXG59O1xyXG5cclxucG9wdXBMaXN0LmZvckVhY2goKGJ0bikgPT4ge1xyXG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgICBpZiAoZS50YXJnZXQgPT0gZS5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIGNsb3NlUG9wdXAocG9wdXBMaXN0KTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn0pOyIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgICAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWwpID0+IHtcclxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgZXJyb3JNZXNzYWdlLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgICAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBlcnJvck1lc3NhZ2UudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYXNPbmx5VmFsaWRJbnB1dHMgPSAoKSA9PiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWwpID0+IHtcclxuICAgICAgICBpZiAoaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICBcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9oYXNPbmx5VmFsaWRJbnB1dHMoKSkge1xyXG4gICAgICAgICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0Rm9ybVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9zY3JpcHRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBvcGVuUG9wdXAsIGNsb3NlUG9wdXAgfSBmcm9tIFwiLi4vc2NyaXB0cy91dGlscy5qc1wiO1xyXG5cclxuXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFt7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxufSxcclxue1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxufSxcclxue1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxufSxcclxue1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbn0sXHJcbntcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbn0sXHJcbntcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxufSxcclxuXTtcclxuXHJcbmluaXRpYWxDYXJkcy5yZXZlcnNlKCk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3B1cHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgZWRpdFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXRcIik7XHJcbmNvbnN0IGFkZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2FkZFwiKTtcclxuY29uc3QgcGxhY2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNcIik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZvcm1zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgZWRpdEZvcm0gPSBlZGl0UG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuY29uc3QgYWRkRm9ybSA9IGFkZFBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdXR0b25zIGFuZCBET00gbm9kZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19wcm9mZXNzaW9uXCIpO1xyXG5jb25zdCBlZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgYWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBjbG9zZUJ0bkxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnB1dHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgcG9wdXBJbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XHJcbmNvbnN0IHBvcHVwSW5wdXRQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIFwiLnBvcHVwX19pbnB1dF90eXBlX3Byb2Zlc3Npb25cIlxyXG4pO1xyXG5jb25zdCBwbGFjZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX3RpdGxlXCIpO1xyXG5jb25zdCBwbGFjZUxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX2xpbmtcIik7XHJcblxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsaWRhdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5jb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm0pO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRGb3JtKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnQgTGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIHBvcHVwSW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgICBwb3B1cElucHV0UHJvZmVzc2lvbi52YWx1ZSA9IHByb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50O1xyXG4gICAgb3BlblBvcHVwKGVkaXRQb3B1cCk7XHJcbn0pO1xyXG5cclxuZWRpdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBwb3B1cElucHV0TmFtZS52YWx1ZTtcclxuICAgIHByb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcG9wdXBJbnB1dFByb2Zlc3Npb24udmFsdWU7XHJcbiAgICBjbG9zZVBvcHVwKGVkaXRQb3B1cCk7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbn0pO1xyXG5cclxuYWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0Rm9ybVZhbGlkYXRpb24oYWRkRm9ybSk7XHJcbiAgICBvcGVuUG9wdXAoYWRkUG9wdXApO1xyXG59KTtcclxuXHJcbmFkZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcmVuZGVyUGxhY2Uoe1xyXG4gICAgICAgIG5hbWU6IHBsYWNlTmFtZS52YWx1ZSxcclxuICAgICAgICBsaW5rOiBwbGFjZUxpbmsudmFsdWVcclxuICAgIH0sIHBsYWNlcyk7XHJcbiAgICBjbG9zZVBvcHVwKGFkZFBvcHVwKTtcclxuICAgIGFkZEZvcm0ucmVzZXQoKTtcclxufSk7XHJcblxyXG5jbG9zZUJ0bkxpc3QuZm9yRWFjaCgoYnRuKSA9PiBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlUG9wdXApKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYWNlLXRlbXBsYXRlXCIpO1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyUGxhY2UoZGF0YSwgY29udGFpbmVyKSB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgY2FyZFRlbXBsYXRlKTtcclxuICAgIGNvbnRhaW5lci5wcmVwZW5kKGNhcmQuZ2V0RWxlbWVudCgpKTtcclxufVxyXG5cclxuaW5pdGlhbENhcmRzLmZvckVhY2goKGRhdGEpID0+IHtcclxuICAgIHJlbmRlclBsYWNlKGRhdGEsIHBsYWNlcyk7XHJcbn0pOyIsImltcG9ydCB7IHByZXZpZXdJbWFnZSwgcHJldmlld1RpdGxlLCBpbWFnZVBvcHVwLCBvcGVuUG9wdXB9IGZyb20gXCIuL3V0aWxzLmpzXCJcclxuXHJcbmNsYXNzIENhcmQge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuXHJcbiAgICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9pbWFnZUVsZW0gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX19pbWFnZVwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkTGlrZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VfX2J1dHRvblwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkRGVsZXRlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZV9fdHJhc2hcIik7XHJcblxyXG4gICAgICAgIHRoaXMuX2ltYWdlRWxlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUHJldmlld0ltYWdlKTtcclxuICAgICAgICB0aGlzLl9jYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcbiAgICAgICAgdGhpcy5fY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlUHJldmlld0ltYWdlID0gKCkgPT4ge1xyXG4gICAgICAgIHByZXZpZXdJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHByZXZpZXdJbWFnZS5hbHQgPSBgSW1hZ2Ugb2YgJHt0aGlzLl9uYW1lfWA7XHJcbiAgICAgICAgcHJldmlld1RpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICBvcGVuUG9wdXAoaW1hZ2VQb3B1cCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUxpa2VCdXR0b24gPSAoKSA9PiB0aGlzLl9jYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwicGxhY2VfX2J1dHRvbl9hY3RpdmVcIik7XHJcblxyXG4gICAgX2hhbmRsZURlbGV0ZUJ1dHRvbiA9ICgpID0+IHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG5cclxuICAgIF9nZXRUZW1wbGF0ZSA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZFNlbGVjdG9yXHJcbiAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2l0ZW1cIilcclxuICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEVsZW1lbnQgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICAgIFwiLnBsYWNlX19pbWFnZVwiXHJcbiAgICAgICAgKS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dGhpcy5fbGlua30pYDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7Il0sIm5hbWVzIjpbImltYWdlUG9wdXAiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3VGl0bGUiLCJwb3B1cExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwib3BlblBvcHVwIiwicG9wdXAiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VQb3B1cEVzYyIsImNsb3NlUG9wdXAiLCJmb3JFYWNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJrZXkiLCJidG4iLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZSIsInRoaXMiLCJfZm9ybSIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9lcnJvckNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9pbnB1dExpc3QiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfaW5wdXRTZWxlY3RvciIsIl90b2dnbGVCdXR0b24iLCJfY2hlY2tJbnB1dFZhbGlkaXR5Iiwic3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2hhc09ubHlWYWxpZElucHV0cyIsImRpc2FibGVkIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJwcmV2ZW50RGVmYXVsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaW5pdGlhbENhcmRzIiwibmFtZSIsImxpbmsiLCJyZXZlcnNlIiwiZWRpdFBvcHVwIiwiYWRkUG9wdXAiLCJwbGFjZXMiLCJlZGl0Rm9ybSIsImFkZEZvcm0iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVQcm9mZXNzaW9uIiwiZWRpdEJ0biIsImFkZEJ0biIsImNsb3NlQnRuTGlzdCIsInBvcHVwSW5wdXROYW1lIiwicG9wdXBJbnB1dFByb2Zlc3Npb24iLCJwbGFjZU5hbWUiLCJwbGFjZUxpbmsiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsInZhbHVlIiwicmVzZXRGb3JtVmFsaWRhdGlvbiIsInJlbmRlclBsYWNlIiwicmVzZXQiLCJjYXJkVGVtcGxhdGUiLCJkYXRhIiwiY29udGFpbmVyIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsIl9pbWFnZUVsZW0iLCJfY2FyZEVsZW1lbnQiLCJfY2FyZExpa2VCdG4iLCJfY2FyZERlbGV0ZUJ0biIsIl9oYW5kbGVQcmV2aWV3SW1hZ2UiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJzcmMiLCJfbGluayIsImFsdCIsIl9uYW1lIiwidG9nZ2xlIiwiX2NhcmRTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZ2V0VGVtcGxhdGUiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInByZXBlbmQiLCJnZXRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==